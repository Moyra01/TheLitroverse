<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>The Litroverse Library</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Google Analytics tag - place immediately after <head> -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-VGW78SBZP4"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-VGW78SBZP4');
  </script>
  <!-- AdSense Auto Ads script -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6271585432301209"
     crossorigin="anonymous"></script>
  <meta name="google-site-verification" content="YOUR-VERIFICATION-CODE-HERE" />
  <link rel="stylesheet" href="style.css">
  <style>
    body { font-family: 'Segoe UI', Arial, sans-serif; }
    .books-container { max-width: 900px; margin: 40px auto; }
    .books-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 32px;
      margin-top: 30px;
    }
    @media (max-width: 600px) {
      .books-grid {
        grid-template-columns: 1fr;
      }
    }
    .book-card {
      background: #fafafa;
      border-radius: 14px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      padding: 16px;
      text-align: center;
      position: relative;
      transition: box-shadow 0.2s;
      min-height: 370px;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
    }
    .book-card:not(.disabled):hover {
      box-shadow: 0 4px 16px rgba(0,0,0,0.15);
      cursor: pointer;
    }
    .book-image {
      width: 100%;
      max-width: 250px;
      height: 220px;
      object-fit: cover;
      border-radius: 10px;
      margin-bottom: 14px;
      filter: blur(0px);
      transition: filter 0.2s;
      background: #ddd;
    }
    .book-card.disabled .book-image {
      filter: blur(8px) grayscale(85%);
    }
    .book-card.disabled {
      opacity: 0.6;
      pointer-events: none;
    }
    .not-published {
      position: absolute;
      top: 10px;
      left: 0;
      right: 0;
      font-size: 1.3em;
      font-weight: bold;
      color: #ff8800;
      background: rgba(255,255,255,0.85);
      border-radius: 0 0 12px 12px;
      padding: 8px 0;
      z-index: 2;
    }
    .adsense-container {
      margin: 30px auto;
      text-align: center;
    }
    .modal { display: none; position: fixed; z-index: 999; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background: rgba(0,0,0,0.6);}
    .modal-content { background: #fff; margin: 5% auto; padding: 24px; border-radius: 10px; width: 80%; max-width: 600px; position: relative;}
    .close { position: absolute; right: 16px; top: 12px; font-size: 2rem; cursor: pointer;}
    .reader-controls { margin: 16px 0;}
  </style>
</head>
<body>
  <!-- Menu -->
  <nav>
    <div class="menu">
      <button id="menuBtn">☰ Menu</button>
      <div id="dropdown" class="dropdown-content">
        <p>Contact us</p>
        <p>Email: dhanganyamamoyra@gmail.com</p>
        <p>Facebook: mjohannes</p>
      </div>
    </div>
  </nav>

  <div class="background"></div>
  <div class="books-container">
    <div class="books-grid" id="booksGrid">
      <!-- Book 1: Accessible, using your uploaded cover and new title -->
      <div class="book-card" id="book1">
        <img class="book-image" src="MJOHANNES.png" alt="Book Cover: A Legacy of Damage">
        <h3>A Legacy of Damage</h3>
        <p>A powerful tale of struggle and hope.</p>
      </div>
      <!-- Book 2: Not published -->
      <div class="book-card disabled" id="book2">
        <div class="not-published">Not Published Yet</div>
        <img class="book-image" src="https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80" alt="Placeholder book">
        <h3>Coming Soon</h3>
        <p>Stay tuned for the next release.</p>
      </div>
      <!-- Book 3: Not published -->
      <div class="book-card disabled" id="book3">
        <div class="not-published">Not Published Yet</div>
        <img class="book-image" src="https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=400&q=80" alt="Placeholder book">
        <h3>Coming Soon</h3>
        <p>Stay tuned for future stories.</p>
      </div>
    </div>
  </div>

  <!-- Modal for reading -->
  <div id="readerModal" class="modal">
    <div class="modal-content">
      <span class="close" id="closeReader">&times;</span>
      <h2 id="bookTitle"></h2>
      <div id="chapterContent"></div>
      <!-- AdSense ad container for manual ad after every 3 pages (hidden by default) -->
      <div id="adContainer" style="margin: 20px 0; display: none;">
        <!-- Square Ad Unit -->
        <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-6271585432301209"
          data-ad-slot="6155779302"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      </div>
      <div class="reader-controls">
        <button id="prevChapter">Previous</button>
        <button id="nextChapter">Next</button>
      </div>
      <button id="continueBtn" style="display:none;">Continue from where you left</button>
    </div>
  </div>

  <script>
  // --- Responsive Books Data ---
  const books = [
    {
      id: "book1",
      title: "A Legacy of Damage",
      cover: "MJOHANNES.png",
      chapters: [
        "Chapter 1: The Beginning<br><br>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque imperdiet.",
        "Chapter 2: The Damage Unfolds<br><br>Quisque eget eros nec urna gravida cursus. Suspendisse potenti.",
        "Chapter 3: The Legacy<br><br>Aliquam erat volutpat. Duis nec commodo erat, nec facilisis erat.",
        "Chapter 4: Healing<br><br>Morbi euismod, enim sed varius finibus, justo tortor cursus erat, sed pretium.",
        "Chapter 5: Hope<br><br>Nam mollis, est a rhoncus molestie, sapien massa sollicitudin quam, a dictum massa."
      ],
      published: true
    },
    {
      id: "book2",
      title: "Coming Soon",
      cover: "https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80",
      chapters: [],
      published: false
    },
    {
      id: "book3",
      title: "Coming Soon",
      cover: "https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=400&q=80",
      chapters: [],
      published: false
    }
  ];

  // --- Render Books ---
  const booksGrid = document.getElementById('booksGrid');
  booksGrid.innerHTML = ""; // Clear any previous content
  books.forEach((book, i) => {
    const card = document.createElement('div');
    card.className = 'book-card' + (book.published ? '' : ' disabled');
    card.id = book.id;
    card.innerHTML = `
      ${!book.published ? '<div class="not-published">Not Published Yet</div>' : ''}
      <img src="${book.cover}" alt="${book.title}" class="book-image">
      <h3>${book.title}</h3>
      <p>${book.published ? "A powerful tale of struggle and hope." : "Stay tuned for " + (i === 1 ? "the next release." : "future stories.")}</p>
    `;
    if (book.published) {
      card.addEventListener('click', () => openReader(book.id));
    }
    booksGrid.appendChild(card);
  });

  // --- Responsive Grid for Mobile ---
  function adjustGridColumns() {
    if (window.innerWidth <= 600) {
      booksGrid.style.gridTemplateColumns = "1fr";
    } else {
      booksGrid.style.gridTemplateColumns = "repeat(3, 1fr)";
    }
  }
  window.addEventListener('resize', adjustGridColumns);
  adjustGridColumns(); // Initial call

  // --- Menu Dropdown ---
  const menuBtn = document.getElementById('menuBtn');
  const dropdown = document.getElementById('dropdown');
  menuBtn.addEventListener('click', function(){
    dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
  });
  window.addEventListener('click', function(e){
    if (!menuBtn.contains(e.target) && !dropdown.contains(e.target)) {
      dropdown.style.display = 'none';
    }
  });

  // --- Reader Modal Logic ---
  const readerModal = document.getElementById('readerModal');
  const closeReader = document.getElementById('closeReader');
  const bookTitle = document.getElementById('bookTitle');
  const chapterContent = document.getElementById('chapterContent');
  const prevChapter = document.getElementById('prevChapter');
  const nextChapter = document.getElementById('nextChapter');
  const continueBtn = document.getElementById('continueBtn');
  const adContainer = document.getElementById('adContainer');

  let currentBook = null;
  let currentChapter = 0;

  // Open modal for first book only
  function openReader(bookId) {
    currentBook = books.find(b => b.id === bookId);
    currentChapter = 0;
    readerModal.style.display = 'block';
    showChapter(currentChapter);

    // Continue button logic (if previously left off)
    const saved = localStorage.getItem('progress_' + bookId);
    if (saved && parseInt(saved) > 0) {
      continueBtn.style.display = '';
      continueBtn.onclick = function() {
        showChapter(parseInt(saved));
        continueBtn.style.display = 'none';
      };
    } else {
      continueBtn.style.display = 'none';
    }
  }

  // Show chapter and AdSense ad every 3 pages
  function showChapter(chapterIndex) {
    if (!currentBook || !currentBook.chapters.length) return;
    currentChapter = chapterIndex;
    bookTitle.textContent = currentBook.title + ' — ' + (currentChapter + 1) + '/' + currentBook.chapters.length;
    chapterContent.innerHTML = currentBook.chapters[currentChapter];
    localStorage.setItem('progress_' + currentBook.id, currentChapter);

    // Show ad after every 3 chapters (on 3, 6, ...)
    if ((chapterIndex + 1) % 3 === 0) {
      adContainer.style.display = 'block';
      // Reload AdSense ad if needed (adsbygoogle push)
      if (window.adsbygoogle) {
        try {
          (adsbygoogle = window.adsbygoogle || []).push({});
        } catch (e) {
          // AdSense might throw if already initialized
        }
      }
    } else {
      adContainer.style.display = 'none';
    }

    prevChapter.disabled = (chapterIndex === 0);
    nextChapter.disabled = (chapterIndex === currentBook.chapters.length - 1);

    // Continue button (simple demo: show on chapter 2+)
    continueBtn.style.display = chapterIndex > 0 ? 'inline-block' : 'none';
  }

  // Previous chapter
  prevChapter.addEventListener('click', function() {
    if (currentBook && currentChapter > 0) {
      showChapter(currentChapter - 1);
    }
  });

  // Next chapter
  nextChapter.addEventListener('click', function() {
    if (currentBook && currentChapter < currentBook.chapters.length - 1) {
      showChapter(currentChapter + 1);
    }
  });

  // Close modal
  closeReader.addEventListener('click', function() {
    readerModal.style.display = 'none';
    currentBook = null;
  });

  // Optional: Close modal when clicking outside modal content
  window.onclick = function(event) {
    if (event.target === readerModal) {
      readerModal.style.display = "none";
      currentBook = null;
    }
  };

  // --- Mobile Swipe Support ---
  let touchStartX = null;
  chapterContent.addEventListener('touchstart', e => {
    touchStartX = e.touches[0].clientX;
  });
  chapterContent.addEventListener('touchend', e => {
    if (!touchStartX) return;
    let touchEndX = e.changedTouches[0].clientX;
    if (touchEndX - touchStartX > 60 && currentChapter > 0) {
      showChapter(currentChapter - 1); // swipe right, prev
    } else if (touchStartX - touchEndX > 60 && currentChapter < currentBook.chapters.length - 1) {
      showChapter(currentChapter + 1); // swipe left, next
    }
    touchStartX = null;
  });
  </script>
</body>
</html>
